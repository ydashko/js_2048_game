{"version":3,"sources":["scripts/main.js"],"names":["startX","startY","endX","endY","messages","document","querySelectorAll","messageLose","querySelector","messageWin","button","cells","table","score","tableGame","randomNumber","resultValue","Math","floor","random","addCell","randomRow","randomCell","render","i","length","row","rows","j","cell","className","textContent","classList","add","filterRow","filter","move","line","push","moveHorizontal","isReversed","reverse","moveVertical","moveLeft","moveRight","moveUp","moveDown","swipe","code","dispatchEvent","window","KeyboardEvent","addEventListener","contains","remove","map","message","blur","e","copyTableGame","JSON","parse","stringify","some","endH","endV","r","c","every","touches","clientX","clientY","abs"],"mappings":";AAAA,aAqPA,SAAA,EAAA,GAAA,OAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,IAAA,SAAA,IAAA,MAAA,IAAA,UAAA,wIAAA,SAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,GAAA,iBAAA,EAAA,OAAA,EAAA,EAAA,GAAA,IAAA,EAAA,OAAA,UAAA,SAAA,KAAA,GAAA,MAAA,GAAA,GAAA,MAAA,WAAA,GAAA,EAAA,cAAA,EAAA,EAAA,YAAA,MAAA,QAAA,GAAA,QAAA,EAAA,MAAA,KAAA,GAAA,cAAA,GAAA,2CAAA,KAAA,GAAA,EAAA,EAAA,QAAA,GAAA,SAAA,EAAA,GAAA,GAAA,oBAAA,QAAA,OAAA,YAAA,OAAA,GAAA,OAAA,MAAA,KAAA,GAAA,SAAA,EAAA,GAAA,GAAA,MAAA,QAAA,GAAA,OAAA,EAAA,GAAA,SAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,UAAA,EAAA,EAAA,QAAA,IAAA,IAAA,EAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,OAAA,EAnPA,IAuOIA,EAAQC,EAAQC,EAAMC,EAvOpBC,EAAWC,SAASC,iBAAiB,YACrCC,EAAcF,SAASG,cAAc,iBACrCC,EAAaJ,SAASG,cAAc,gBACpCE,EAASL,SAASG,cAAc,WAChCG,EAAQN,SAASC,iBAAiB,eAClCM,EAAQP,SAASG,cAAc,eAC/BK,EAAQR,SAASG,cAAc,eAE/BM,EAAY,CAChB,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,IA2GZ,SAASC,IACHC,IAAAA,EAAc,EAOXA,OAJQ,IAFAC,KAAKC,MAAsB,GAAhBD,KAAKE,YAG7BH,EAAc,GAGTA,EAGT,SAASI,IAIAN,IAHHO,IAAAA,EAAYJ,KAAKC,MAAsB,EAAhBD,KAAKE,UAC5BG,EAAaL,KAAKC,MAAsB,EAAhBD,KAAKE,UAEW,IAArCL,EAAUO,GAAWC,IAC1BD,EAAYJ,KAAKC,MAAsB,EAAhBD,KAAKE,UAC5BG,EAAaL,KAAKC,MAAsB,EAAhBD,KAAKE,UAG/BL,EAAUO,GAAWC,GAAcP,IAGrC,SAASQ,IACF,IAAA,IAAIC,EAAI,EAAGA,EAAIV,EAAUW,OAAQD,IAG/B,IAFCE,IAAAA,EAAMd,EAAMe,KAAKH,GAEdI,EAAI,EAAGA,EAAId,EAAUU,GAAGC,OAAQG,IAAK,CACtCC,IAAAA,EAAOH,EAAIf,MAAMiB,GAEvBC,EAAKC,UAAY,aACjBD,EAAKE,YAAc,GAEK,IAApBjB,EAAUU,GAAGI,KACfC,EAAKG,UAAUC,IAAmBnB,eAAAA,OAAAA,EAAUU,GAAGI,KAC/CC,EAAKE,YAAcjB,EAAUU,GAAGI,KAMxC,SAASM,EAAUR,GACVA,OAAAA,EAAIS,OAAO,SAAAN,GAAQA,OAAS,IAATA,IAG5B,SAASO,EAAKV,GAGP,IAFDW,IAAAA,EAAOH,EAAUR,GAEZE,EAAI,EAAGA,EAAIS,EAAKZ,OAAS,EAAGG,IAC/BS,EAAKT,KAAOS,EAAKT,EAAI,KACvBS,EAAKT,IAAM,EACXS,EAAKT,EAAI,GAAK,EACdf,EAAMkB,aAAelB,EAAMkB,cAAeM,EAAKT,IAM5CS,IAFPA,EAAOH,EAAUG,GAEVA,EAAKZ,OAASX,EAAUW,QAC7BY,EAAKC,KAAK,GAGLD,OAAAA,EAGT,SAASE,EAAeC,GACjB,IAAA,IAAIhB,EAAI,EAAGA,EAAIV,EAAUW,OAAQD,IAAK,CACrCE,IAAAA,EAAMZ,EAAUU,GAEpBgB,GAAcd,EAAIe,UAClBf,EAAMU,EAAKV,GACXc,GAAcd,EAAIe,UAClB3B,EAAUU,GAAKE,GAInB,SAASgB,EAAaF,GACf,IAAA,IAAIhB,EAAI,EAAGA,EAAIV,EAAUW,OAAQD,IAAK,CACrCE,IAAAA,EAAM,CACRZ,EAAU,GAAGU,GAAIV,EAAU,GAAGU,GAAIV,EAAU,GAAGU,GAAIV,EAAU,GAAGU,IAGlEgB,GAAcd,EAAIe,UAClBf,EAAMU,EAAKV,GACXc,GAAcd,EAAIe,UAClB3B,EAAU,GAAGU,GAAKE,EAAI,GACtBZ,EAAU,GAAGU,GAAKE,EAAI,GACtBZ,EAAU,GAAGU,GAAKE,EAAI,GACtBZ,EAAU,GAAGU,GAAKE,EAAI,IAI1B,SAASiB,IACPJ,IAGF,SAASK,IACPL,GAAe,GAGjB,SAASM,IACPH,IAGF,SAASI,IACPJ,GAAa,GAGf,SAASK,EAAMC,GACb3C,SAAS4C,cAAc,IAAIC,OAAOC,cAAc,QAAS,CAAUH,KAAAA,KArNrEtC,EAAO0C,iBAAiB,QAAS,WAC1B1C,EAAOsB,UAAUqB,SAAS,aAC7B3C,EAAOsB,UAAUsB,OAAO,SACxB5C,EAAOsB,UAAUC,IAAI,WACrBvB,EAAOqB,YAAc,WAGlB,IAAA,IAAIP,EAAI,EAAGA,EAAIV,EAAUW,OAAQD,IAC/B,IAAA,IAAII,EAAI,EAAGA,EAAId,EAAUU,GAAGC,OAAQG,IACvCd,EAAUU,GAAGI,GAAK,EAIlBxB,EAAAA,GAAUmD,IAAI,SAAAC,GAAWA,OAAAA,EAAQxB,UAAUC,IAAI,YACnDpB,EAAMkB,YAAc,EAEhBpB,EAAAA,GAAO4C,IAAI,SAAA1B,GACbA,EAAKC,UAAY,aACjBD,EAAKE,YAAc,KAGrBX,IACAA,IACAG,IACAb,EAAO+C,SAGTpD,SAAS+C,iBAAiB,QAAS,SAAAM,GAC7B,GAAChD,EAAOsB,UAAUqB,SAAS,YACzB9C,EAAYyB,UAAUqB,SAAS,WAC/B5C,EAAWuB,UAAUqB,SAAS,UAFhC,CAMEM,IAAAA,EAAgBC,KAAKC,MAAMD,KAAKE,UAAUhD,IAExC4C,OAAAA,EAAEV,MACH,IAAA,YACHL,IACA,MAEG,IAAA,aACHC,IACA,MAEG,IAAA,UACHC,IACA,MAEG,IAAA,YACHC,IACA,MAEF,QACE,OAGAc,GAAAA,KAAKE,UAAUH,KAAmBC,KAAKE,UAAUhD,GAAjD8C,CAIJxC,IACAG,IAEI,EAAIZ,GAAOoD,KAAK,SAAAlC,GAAQA,OAAAA,EAAKG,UAAUqB,SAAS,uBAClD5C,EAAWuB,UAAUsB,OAAO,UAMzB,IAHDU,IAAAA,GAAO,EACPC,GAAO,EAEFC,EAAI,EAAGA,EAAIpD,EAAUW,OAAQyC,IAC/B,IAAA,IAAIC,EAAI,EAAGA,EAAIrD,EAAUW,OAAS,EAAG0C,IACpCrD,GAAAA,EAAUoD,GAAGC,KAAOrD,EAAUoD,GAAGC,EAAI,GAGvC,YAFAH,GAAO,GAOR,IAAA,IAAIE,EAAI,EAAGA,EAAIpD,EAAUW,OAAQyC,IAK/B,IAJCxC,IAAAA,EAAM,CACVZ,EAAU,GAAGoD,GAAIpD,EAAU,GAAGoD,GAAIpD,EAAU,GAAGoD,GAAIpD,EAAU,GAAGoD,IAGzDC,EAAI,EAAGA,EAAIzC,EAAID,OAAS,EAAG0C,IAC9BzC,GAAAA,EAAIyC,KAAOzC,EAAIyC,EAAI,GAGrB,YAFAF,GAAO,GAQXnD,EAAUsD,MAAM,SAAA1C,GAAOA,OAAAA,EAAI0C,MAAM,SAAAvC,GAAQA,OAAS,IAATA,QAC7B,IAAToC,IACS,IAATD,GAEHzD,EAAYyB,UAAUsB,OAAO,cAsHjCjD,SAAS+C,iBAAiB,aAAc,SAAAM,GACtC1D,EAAS0D,EAAEW,QAAQ,GAAGC,QACtBrE,EAASyD,EAAEW,QAAQ,GAAGE,UAGxBlE,SAAS+C,iBAAiB,YAAa,SAAAM,GACrCxD,EAAOwD,EAAEW,QAAQ,GAAGC,QAAUtE,EAC9BG,EAAOuD,EAAEW,QAAQ,GAAGE,QAAUtE,IAGhCI,SAAS+C,iBAAiB,WAAY,SAAAM,GAChCzC,KAAKuD,IAAItE,GAAQe,KAAKuD,IAAIrE,GAE1B4C,EADE7C,EAAO,EACH,YAEA,cAIN6C,EADE5C,EAAO,EACH,UAEA","file":"main.5653d822.js","sourceRoot":"../src","sourcesContent":["'use strict';\n\nconst messages = document.querySelectorAll('.message');\nconst messageLose = document.querySelector('.message-lose');\nconst messageWin = document.querySelector('.message-win');\nconst button = document.querySelector('.button');\nconst cells = document.querySelectorAll('.field-cell');\nconst table = document.querySelector('.game-field');\nconst score = document.querySelector('.game-score');\n\nconst tableGame = [\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n];\n\nbutton.addEventListener('click', () => {\n  if (!button.classList.contains('restart')) {\n    button.classList.remove('start');\n    button.classList.add('restart');\n    button.textContent = 'Restart';\n  }\n\n  for (let i = 0; i < tableGame.length; i++) {\n    for (let j = 0; j < tableGame[i].length; j++) {\n      tableGame[i][j] = 0;\n    }\n  }\n\n  [...messages].map(message => message.classList.add('hidden'));\n  score.textContent = 0;\n\n  [...cells].map(cell => {\n    cell.className = 'field-cell';\n    cell.textContent = '';\n  });\n\n  addCell();\n  addCell();\n  render();\n  button.blur();\n});\n\ndocument.addEventListener('keyup', e => {\n  if (!button.classList.contains('restart')\n    || !messageLose.classList.contains('hidden')\n    || !messageWin.classList.contains('hidden')) {\n    return;\n  }\n\n  const copyTableGame = JSON.parse(JSON.stringify(tableGame));\n\n  switch (e.code) {\n    case 'ArrowLeft':\n      moveLeft();\n      break;\n\n    case 'ArrowRight':\n      moveRight();\n      break;\n\n    case 'ArrowUp':\n      moveUp();\n      break;\n\n    case 'ArrowDown':\n      moveDown();\n      break;\n\n    default:\n      return;\n  }\n\n  if (JSON.stringify(copyTableGame) === JSON.stringify(tableGame)) {\n    return;\n  }\n\n  addCell();\n  render();\n\n  if ([...cells].some(cell => cell.classList.contains('field-cell--2048'))) {\n    messageWin.classList.remove('hidden');\n  }\n\n  let endH = true;\n  let endV = true;\n\n  for (let r = 0; r < tableGame.length; r++) {\n    for (let c = 0; c < tableGame.length - 1; c++) {\n      if (tableGame[r][c] === tableGame[r][c + 1]) {\n        endH = false;\n\n        return;\n      }\n    }\n  }\n\n  for (let r = 0; r < tableGame.length; r++) {\n    const row = [\n      tableGame[0][r], tableGame[1][r], tableGame[2][r], tableGame[3][r],\n    ];\n\n    for (let c = 0; c < row.length - 1; c++) {\n      if (row[c] === row[c + 1]) {\n        endV = false;\n\n        return;\n      }\n    }\n  }\n\n  if (\n    tableGame.every(row => row.every(cell => cell !== 0))\n    && endV === true\n    && endH === true\n  ) {\n    messageLose.classList.remove('hidden');\n  }\n});\n\nfunction randomNumber() {\n  let resultValue = 2;\n  const number = Math.floor(Math.random() * 10);\n\n  if (number === 0) {\n    resultValue = 4;\n  }\n\n  return resultValue;\n}\n\nfunction addCell() {\n  let randomRow = Math.floor(Math.random() * 4);\n  let randomCell = Math.floor(Math.random() * 4);\n\n  while (tableGame[randomRow][randomCell] !== 0) {\n    randomRow = Math.floor(Math.random() * 4);\n    randomCell = Math.floor(Math.random() * 4);\n  }\n\n  tableGame[randomRow][randomCell] = randomNumber();\n}\n\nfunction render() {\n  for (let i = 0; i < tableGame.length; i++) {\n    const row = table.rows[i];\n\n    for (let j = 0; j < tableGame[i].length; j++) {\n      const cell = row.cells[j];\n\n      cell.className = 'field-cell';\n      cell.textContent = '';\n\n      if (tableGame[i][j] !== 0) {\n        cell.classList.add(`field-cell--${tableGame[i][j]}`);\n        cell.textContent = tableGame[i][j];\n      }\n    }\n  }\n}\n\nfunction filterRow(row) {\n  return row.filter(cell => cell !== 0);\n}\n\nfunction move(row) {\n  let line = filterRow(row);\n\n  for (let j = 0; j < line.length - 1; j++) {\n    if (line[j] === line[j + 1]) {\n      line[j] *= 2;\n      line[j + 1] = 0;\n      score.textContent = +score.textContent + +line[j];\n    }\n  }\n\n  line = filterRow(line);\n\n  while (line.length < tableGame.length) {\n    line.push(0);\n  }\n\n  return line;\n}\n\nfunction moveHorizontal(isReversed) {\n  for (let i = 0; i < tableGame.length; i++) {\n    let row = tableGame[i];\n\n    isReversed && row.reverse();\n    row = move(row);\n    isReversed && row.reverse();\n    tableGame[i] = row;\n  }\n}\n\nfunction moveVertical(isReversed) {\n  for (let i = 0; i < tableGame.length; i++) {\n    let row = [\n      tableGame[0][i], tableGame[1][i], tableGame[2][i], tableGame[3][i],\n    ];\n\n    isReversed && row.reverse();\n    row = move(row);\n    isReversed && row.reverse();\n    tableGame[0][i] = row[0];\n    tableGame[1][i] = row[1];\n    tableGame[2][i] = row[2];\n    tableGame[3][i] = row[3];\n  }\n}\n\nfunction moveLeft() {\n  moveHorizontal();\n}\n\nfunction moveRight() {\n  moveHorizontal(true);\n}\n\nfunction moveUp() {\n  moveVertical();\n}\n\nfunction moveDown() {\n  moveVertical(true);\n}\n\nfunction swipe(code) {\n  document.dispatchEvent(new window.KeyboardEvent('keyup', { 'code': code }));\n}\n\nlet startX, startY, endX, endY;\n\ndocument.addEventListener('touchstart', e => {\n  startX = e.touches[0].clientX;\n  startY = e.touches[0].clientY;\n});\n\ndocument.addEventListener('touchmove', e => {\n  endX = e.touches[0].clientX - startX;\n  endY = e.touches[0].clientY - startY;\n});\n\ndocument.addEventListener('touchend', e => {\n  if (Math.abs(endX) > Math.abs(endY)) {\n    if (endX < 0) {\n      swipe('ArrowLeft');\n    } else {\n      swipe('ArrowRight');\n    }\n  } else {\n    if (endY < 0) {\n      swipe('ArrowUp');\n    } else {\n      swipe('ArrowDown');\n    }\n  }\n});\n"]}